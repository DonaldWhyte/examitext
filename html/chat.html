<html>

<head>
	<title>Chat Analyser</title>

	<!-- External libraries -->
	<script type="text/javascript" src="../js/jquery-1.6.2.js"></script>


	<script type="text/javascript" src="../js/stemmer.js"></script>
	<script type="text/javascript" src="../js/stoplist.js"></script>
	<script type="text/javascript" src="../js/statistics.js"></script>
	<script type="text/javascript" src="../js/log_processor.js"></script>
	<script type="text/javascript">
	function getText() {
		var form = document.forms("logForm")
		;
		var localFile = form.elements["localFile"];
		if (localFile.value != "") {
			// LOAD FILE
			// GET TEXT FROM IT
		}

		var rawText = form.elements["rawText"];
		if (rawText.value != "") {
			return rawText.value;
		}

		return "";
	}

	function analyse() {
		// Get source text
		var text = getText();
		if (text != "") {
			// Analyse text and get results
			statistics = getParticipantStatistics(processLog(text));
			// Interpret statistics
						
			// Create graphs from the results


			$("#formContainer").hide("fast");
			$("#resultsContainer").show("fast");
		} else {
			$("#messageContainer").hide();
			$("#messageContainer").html("<p class='text_center red'><strong>No file or raw text provided.</strong></p>");
			$("#messageContainer").show("slow").delay(3500).hide("slow");
		}
	}
	</script>

	<!-- Script for laying out the webpage-->
	<script type="text/javascript">
	jQuery.fn.center_x = function() {
		this.css("position","absolute");
		this.css("left", (($(window).width() - this.outerWidth()) / 2) + $(window).scrollLeft() + "px");
	}
	jQuery.fn.center_y = function() {
		this.css("position","absolute");
		this.css("top", (($(window).height() - this.outerHeight()) / 2) + $(window).scrollTop() + "px");
	}
	jQuery.fn.center = function() {
		this.center_x();
		this.center_y();
	    return this;
	}
	</script>

	<link rel="stylesheet" type="text/css" href="../css/reset.css" />
	<link rel="stylesheet" type="text/css" href="../css/style.css" />

</head>

<body>

	<div id="container" class="rounded_corners_all">
		<div id="header" class="rounded_corners_top">
			<h1>Chat Log Analyser</h1>
		</div>

		<div id="content">
			<div id="formContainer">
				<form name="logForm" action="#">
					<table class="form_table">
						<tr><td><strong>Upload File:</strong></td><td><input name="localFile" type="file" class="textbox" /></td></tr>

						<tr><td><strong>Raw Text:</strong></td></tr>

						<tr><td colspan="2"><textarea name="rawText" rows="15" cols="150"></textarea></td></tr>
					</table>
				</form>
				<br />
				<a href="javascript:analyse()" class="analyseButton">Analyse</a>
				<br />
				<br />
				<div id="messageContainer"></div>
				<br />
			</div>

			<!-- Empty at the moment, just here so the div is created. -->
			<div id="resultsContainer">
			</div>
		</div>

		<div id="footer">
			<p>Copyright 2011 Donald Whyte</p>
		</div>
	</div>

	<!-- We center the container here since it's been populated with all
	     its content by this point. -->
	<script type="text/javascript">
		$("#container").center();
	</script>

</body>

</html>

<!-- Test code, just putting it here and commenting it out since I might need it in the future  -->
<!--<script type="text/javascript">
var log = "[Donald]: The stats on that fathom were unfathomable. The two teams will play an exciting rivalry game next week. The gymnast gingerly landed her triple backflip supreme. The incredulous cop cuffed the passenger of a van suspected of containing 13 kilos of cocaine. The criminals walked out of prison in a very nonchalant manner. In order to get anywhere in life one must abide by the rules of society. The cheesesteak will be digested by Steve in an hour or so. Steve can be such a pig...\nDonald says: Hey!\nBob says: Hello my good friend from the land of rain. How are you?\nRichard: Hello my good friend!\nThe Nameless One: Who the hell are you?";
var messages = processLog(log);

document.write("<p>--END MESSAGE COLLECTION TEST--</p>");

var messageStatistics = getParticipantStatistics(messages);

document.write("<table><tr><th>Name</th><th>Percent of Messages</th><th>Num Messages</th><th>Average Message Length</th><th>Average Message Density></th></tr>");
for (var name in messageStatistics) {
	var participant = messageStatistics[name];
	document.write("<tr><td>" + name + "</td><td>" + participant.percentOfMessages + "</td><td>" +
		participant.numMessages + "</td><td>" +  participant.averageMessageLength + "</td><td>" +
		participant.averageMessageDensity + "</td></tr>");
}
document.write("</table>");

document.write("<h3>Word Frequencies for Bob</h3><table>");
for (var i in messageStatistics["Bob"].wordFrequency) {
	document.write("<tr><td>" + i + "</td><td>" + messageStatistics["Bob"].wordFrequency[i] + "</td></tr>");
}
document.write("</table>");

document.write("<h3>Relative Word Frequencies for Bob</h3><table>");
document.write("<tr><td>Total Words</td><td>" + messageStatistics["Bob"].wordCount + "</td></tr>");
for (var i in messageStatistics["Bob"].relativeWordFrequency) {
	document.write("<tr><td>" + i + "</td><td>" + messageStatistics["Bob"].relativeWordFrequency[i] + "</td></tr>");
}
document.write("</table>");

document.write("<p>--END STATISTICS TEST--</p>");
</script>-->